{"ast":null,"code":"var _jsxFileName = \"/Users/mac3/Desktop/workspace/PosClient/src/features/dashboard/components/order/components/order-print/index.tsx\",\n    _s = $RefreshSig$();\n\nimport { PrinterOutlined } from '@ant-design/icons';\nimport { Button, message } from 'antd';\nimport { get } from 'lodash';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { useReactToPrint } from 'react-to-print';\nimport orderApi from '../../../../../../api/order-api';\nimport { BillToPrintComponent } from '../../../template';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst OrderPrint = ({\n  order,\n  callback,\n  isNew = false\n}) => {\n  _s();\n\n  const store = useSelector(state => state.store.store);\n  const componentRef = useRef();\n  const [loading, setLoading] = useState(false);\n  const [orderLocal, setOrderLocal] = useState(order);\n  useEffect(() => {\n    async function loadOrder() {\n      try {\n        const orderId = get(order, '_id');\n\n        if (orderId) {\n          const response = await orderApi.getOrder({\n            storeId: store._id,\n            orderId\n          });\n          setOrderLocal({ ...order,\n            products: response.products\n          });\n        }\n      } catch (error) {}\n    }\n\n    if (isNew) {\n      loadOrder();\n    }\n  }, [isNew, order, store._id]);\n\n  const onPrintError = () => {\n    message.error('In hoá đơn thất bại');\n    setLoading(false);\n  };\n\n  const onAfterPrint = () => {\n    setLoading(false);\n\n    if (typeof callback === 'function') {\n      callback();\n    }\n  };\n\n  const handlePrint = useReactToPrint({\n    content: () => componentRef.current,\n    documentTitle: `Hoá đơn ${orderLocal.code}`,\n    onBeforeGetContent: () => setLoading(true),\n    onAfterPrint: onAfterPrint,\n    onPrintError: onPrintError,\n    removeAfterPrint: true\n  });\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Button, {\n      type: \"primary\",\n      icon: /*#__PURE__*/_jsxDEV(PrinterOutlined, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 23\n      }, this),\n      loading: loading,\n      onClick: handlePrint,\n      children: \"In h\\xF3a \\u0111\\u01A1n\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'none'\n      },\n      children: /*#__PURE__*/_jsxDEV(BillToPrintComponent, {\n        order: orderLocal,\n        ref: componentRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n\n_s(OrderPrint, \"M7wTpi4/RS/Rpho5j0Gf3yv4HTk=\", false, function () {\n  return [useSelector, useReactToPrint];\n});\n\n_c = OrderPrint;\nexport default OrderPrint;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderPrint\");","map":{"version":3,"sources":["/Users/mac3/Desktop/workspace/PosClient/src/features/dashboard/components/order/components/order-print/index.tsx"],"names":["PrinterOutlined","Button","message","get","React","useEffect","useRef","useState","useSelector","useReactToPrint","orderApi","BillToPrintComponent","OrderPrint","order","callback","isNew","store","state","componentRef","loading","setLoading","orderLocal","setOrderLocal","loadOrder","orderId","response","getOrder","storeId","_id","products","error","onPrintError","onAfterPrint","handlePrint","content","current","documentTitle","code","onBeforeGetContent","removeAfterPrint","display"],"mappings":"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","sourcesContent":["import { PrinterOutlined } from '@ant-design/icons';\nimport { Button, message } from 'antd';\nimport { get } from 'lodash';\nimport React, { FC, useEffect, useRef, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { useReactToPrint } from 'react-to-print';\nimport orderApi from '../../../../../../api/order-api';\nimport { IOrderBill } from '../../../../../../collections/order';\nimport { BillToPrintComponent } from '../../../template';\n\ninterface Props {\n    order: IOrderBill;\n    callback?: () => void;\n    isNew?: boolean;\n}\n\nconst OrderPrint: FC<Props> = ({ order, callback, isNew = false }) => {\n    const store = useSelector((state: any) => state.store.store);\n    const componentRef = useRef<any>();\n    const [loading, setLoading] = useState(false);\n    const [orderLocal, setOrderLocal] = useState<IOrderBill>(order);\n\n    useEffect(() => {\n        async function loadOrder() {\n            try {\n                const orderId = get(order, '_id');\n                if (orderId) {\n                    const response: any = await orderApi.getOrder({\n                        storeId: store._id,\n                        orderId,\n                    });\n\n                    setOrderLocal({ ...order, products: response.products });\n                }\n            } catch (error) {}\n        }\n        if (isNew) {\n            loadOrder();\n        }\n    }, [isNew, order, store._id]);\n\n    const onPrintError = () => {\n        message.error('In hoá đơn thất bại');\n        setLoading(false);\n    };\n\n    const onAfterPrint = () => {\n        setLoading(false);\n        if (typeof callback === 'function') {\n            callback();\n        }\n    };\n\n    const handlePrint = useReactToPrint({\n        content: () => componentRef.current,\n        documentTitle: `Hoá đơn ${orderLocal.code}`,\n        onBeforeGetContent: () => setLoading(true),\n        onAfterPrint: onAfterPrint,\n        onPrintError: onPrintError,\n        removeAfterPrint: true,\n    });\n\n    return (\n        <>\n            <Button\n                type='primary'\n                icon={<PrinterOutlined />}\n                loading={loading}\n                onClick={handlePrint}\n            >\n                In hóa đơn\n            </Button>\n            <div style={{ display: 'none' }}>\n                <BillToPrintComponent order={orderLocal} ref={componentRef} />\n            </div>\n        </>\n    );\n};\n\nexport default OrderPrint;\n"]},"metadata":{},"sourceType":"module"}