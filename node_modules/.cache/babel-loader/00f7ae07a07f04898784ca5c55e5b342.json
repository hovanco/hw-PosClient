{"ast":null,"code":"var _jsxFileName = \"/Users/mac3/Desktop/workspace/PosClient/src/features/dashboard/components/search-product/index.tsx\",\n    _s = $RefreshSig$();\n\nimport { debounce } from 'lodash';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport productApi from '../../../../api/product-api';\nimport SearchDropdown from '../../../../components/search-dropdown';\nimport { ProductProvider } from '../../pages/products/context';\nimport ProviderContext from './context';\nimport InputSearch from './input-search';\nimport ProductsDropdown from './products-dropdown';\nimport './search-product.less';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst SearchProduct = ({\n  selectProduct,\n  productRowRender\n}) => {\n  _s();\n\n  const store = useSelector(state => state.store.store);\n  const warehouseId = useSelector(state => state.store.warehouseId);\n  const [loading, setLoading] = useState(true);\n  const [products, setProducts] = useState([]);\n  const inputRef = useRef();\n  const focusInput = useCallback(e => {\n    if (e.code === 'F2' && inputRef.current) {\n      return inputRef.current.focus();\n    }\n\n    return null;\n  }, []);\n  const onChange = debounce(text_string => {\n    setLoading(true);\n    productApi.getProducts({\n      storeId: store._id,\n      page: 1,\n      limit: 20,\n      search: text_string,\n      warehouseId,\n      withQuantity: true,\n      variant: true\n    }).then(response => {\n      setProducts((response === null || response === void 0 ? void 0 : response.data) || []);\n    }).catch(() => {\n      setProducts([]);\n    }).finally(() => {\n      setLoading(false);\n    });\n  }, 300);\n\n  const handleSelectProduct = product => {\n    selectProduct(product);\n  };\n\n  useEffect(() => {\n    onChange();\n  }, []);\n  useEffect(() => {\n    document.addEventListener('keydown', focusInput);\n    return () => {\n      document.removeEventListener('keydown', focusInput);\n    };\n  }, [focusInput]);\n  return /*#__PURE__*/_jsxDEV(ProviderContext, {\n    selectProduct: handleSelectProduct,\n    children: /*#__PURE__*/_jsxDEV(ProductProvider, {\n      children: /*#__PURE__*/_jsxDEV(SearchDropdown, {\n        className: \"search-product\",\n        input: /*#__PURE__*/_jsxDEV(InputSearch, {\n          onChange: onChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 28\n        }, this),\n        children: /*#__PURE__*/_jsxDEV(ProductsDropdown, {\n          products: products,\n          loading: loading,\n          productRowRender: productRowRender\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 9\n  }, this);\n};\n\n_s(SearchProduct, \"tQ4gvHJl+nfnaJYakNHHtr1DYNw=\", false, function () {\n  return [useSelector, useSelector];\n});\n\n_c = SearchProduct;\nexport default SearchProduct;\n\nvar _c;\n\n$RefreshReg$(_c, \"SearchProduct\");","map":{"version":3,"sources":["/Users/mac3/Desktop/workspace/PosClient/src/features/dashboard/components/search-product/index.tsx"],"names":["debounce","React","useCallback","useEffect","useRef","useState","useSelector","productApi","SearchDropdown","ProductProvider","ProviderContext","InputSearch","ProductsDropdown","SearchProduct","selectProduct","productRowRender","store","state","warehouseId","loading","setLoading","products","setProducts","inputRef","focusInput","e","code","current","focus","onChange","text_string","getProducts","storeId","_id","page","limit","search","withQuantity","variant","then","response","data","catch","finally","handleSelectProduct","product","document","addEventListener","removeEventListener"],"mappings":"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","sourcesContent":["import { debounce } from 'lodash';\nimport React, { FC, useCallback, useEffect, useRef, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport productApi from '../../../../api/product-api';\nimport { IProduct } from '../../../../collections/product';\nimport SearchDropdown from '../../../../components/search-dropdown';\nimport { ProductProvider } from '../../pages/products/context';\nimport { ProductState } from '../../pages/sales-counters/state/interface';\nimport ProviderContext from './context';\nimport InputSearch from './input-search';\nimport ProductsDropdown from './products-dropdown';\nimport './search-product.less';\n\ninterface Props {\n    selectProduct: (product: ProductState) => void;\n    productRowRender?: any;\n}\n\nconst SearchProduct: FC<Props> = ({ selectProduct, productRowRender }) => {\n    const store = useSelector((state: any) => state.store.store);\n    const warehouseId = useSelector((state: any) => state.store.warehouseId);\n\n    const [loading, setLoading] = useState<boolean>(true);\n    const [products, setProducts] = useState<IProduct[]>([]);\n\n    const inputRef = useRef<any>();\n\n    const focusInput = useCallback((e: any) => {\n        if (e.code === 'F2' && inputRef.current) {\n            return inputRef.current.focus();\n        }\n        return null;\n    }, []);\n\n    const onChange = debounce((text_string?: string) => {\n        setLoading(true);\n\n        productApi\n            .getProducts({\n                storeId: store._id,\n                page: 1,\n                limit: 20,\n                search: text_string,\n                warehouseId,\n                withQuantity: true,\n                variant: true,\n            })\n            .then((response: any) => {\n                setProducts(response?.data || []);\n            })\n            .catch(() => {\n                setProducts([]);\n            })\n            .finally(() => {\n                setLoading(false);\n            });\n    }, 300);\n\n    const handleSelectProduct = (product: ProductState) => {\n        selectProduct(product);\n    };\n\n    useEffect(() => {\n        onChange();\n    }, []);\n\n    useEffect(() => {\n        document.addEventListener('keydown', focusInput);\n\n        return () => {\n            document.removeEventListener('keydown', focusInput);\n        };\n    }, [focusInput]);\n\n    return (\n        <ProviderContext selectProduct={handleSelectProduct}>\n            <ProductProvider>\n                <SearchDropdown\n                    className='search-product'\n                    input={<InputSearch onChange={onChange} />}\n                >\n                    <ProductsDropdown\n                        products={products}\n                        loading={loading}\n                        productRowRender={productRowRender}\n                    />\n                </SearchDropdown>\n            </ProductProvider>\n        </ProviderContext>\n    );\n};\n\nexport default SearchProduct;\n"]},"metadata":{},"sourceType":"module"}