{"ast":null,"code":"var _jsxFileName = \"/Users/mac3/Desktop/workspace/PosClient/src/features/dashboard/pages/sales-counters/state/context.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { createContext, useCallback, useContext, useEffect, useMemo } from 'react';\nimport { useImmerReducer } from 'use-immer';\nimport { useSelector } from 'react-redux';\nimport { getPackagesActive } from '../../../../../api/billing-api';\nimport { checkRestrictAction } from '../../../../../utils/get-time';\nimport { useOrdersDraft } from './orders-draft-context';\nimport reducer, { initialState } from './reducer';\nimport { types } from './types';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialContext = {\n  state: initialState,\n  dispatch: () => {}\n};\nconst Context = /*#__PURE__*/createContext(initialContext);\n\nconst ProviderContext = ({\n  children,\n  order\n}) => {\n  _s();\n\n  const {\n    updateOrdersDraft\n  } = useOrdersDraft();\n  const [state, dispatch] = useImmerReducer(reducer, order || initialState);\n  useEffect(() => {\n    dispatch({\n      type: types.LOAD_NEW_ORDER_DRAFT,\n      payload: order\n    });\n  }, [order.id]);\n  useEffect(() => {\n    if (state.id === order.id) {\n      updateOrdersDraft(state);\n    } else {\n      dispatch({\n        type: types.LOAD_NEW_ORDER_DRAFT,\n        payload: order\n      });\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [state.id, state.products, state.payments, state.customer, state.shipment, state.customerNote, state.moneyCustomer, state.delivered, state.sale, state.isRestrictAction, state.createdBy]); // eslint-disable-next-line\n\n  const value = useMemo(() => ({\n    state,\n    dispatch\n  }), [state]);\n  return /*#__PURE__*/_jsxDEV(Context.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 12\n  }, this);\n};\n\n_s(ProviderContext, \"gFQeRmoTMTPIwt3t16tqdIRvMTs=\", false, function () {\n  return [useOrdersDraft, useImmerReducer];\n});\n\n_c = ProviderContext;\nexport const useSalesCounter = () => {\n  _s2();\n\n  const value = useContext(Context);\n  const {\n    state,\n    dispatch\n  } = value;\n  const store = useSelector(state => state.store.store);\n\n  const getPackages = async () => {\n    const packages = await getPackagesActive(store._id);\n    const pkgsActive = packages.filter(item => item.active);\n    dispatch({\n      type: types.CHANGE_IS_RESTRICT_ACTION,\n      payload: checkRestrictAction(pkgsActive)\n    });\n  };\n\n  const addProduct = useCallback(product => {\n    dispatch({\n      type: types.ADD_PRODUCT,\n      payload: product\n    }); // eslint-disable-next-line\n  }, []);\n\n  const removeProduct = product => {\n    dispatch({\n      type: types.REMOVE_PRODUCT,\n      payload: product\n    });\n  };\n\n  const updateCount = useCallback(product => {\n    dispatch({\n      type: types.UPDATE_QUANTITY,\n      payload: product\n    }); // eslint-disable-next-line\n  }, []);\n  const addCustomer = useCallback(customer => {\n    dispatch({\n      type: types.ADD_CUSTOMER,\n      payload: customer\n    }); // eslint-disable-next-line\n  }, []);\n  const addPayment = useCallback(payment => {\n    dispatch({\n      type: types.ADD_PAYMENT,\n      payload: payment\n    }); // eslint-disable-next-line\n  }, []);\n  const updatePayment = useCallback(payment => {\n    dispatch({\n      type: types.UPDATE_PAYMENT,\n      payload: payment\n    }); // eslint-disable-next-line\n  }, []);\n  const removePayment = useCallback(payment => {\n    dispatch({\n      type: types.REMOVE_PAYMENT,\n      payload: payment\n    }); // eslint-disable-next-line\n  }, []);\n  const addShipment = useCallback(shipment => {\n    dispatch({\n      type: types.ADD_SHIPMENT,\n      payload: shipment\n    }); // eslint-disable-next-line\n  }, []);\n  const addCustomerNote = useCallback(note => {\n    dispatch({\n      type: types.ADD_CUSTOMER_NOTE,\n      payload: note\n    }); // eslint-disable-next-line\n  }, []);\n  const changeDelivered = useCallback(check => {\n    dispatch({\n      type: types.CHANGE_DELIVERED,\n      payload: check\n    }); // eslint-disable-next-line\n  }, []);\n  const changeSale = useCallback(check => {\n    dispatch({\n      type: types.CHANGE_SALE,\n      payload: check\n    }); // eslint-disable-next-line\n  }, []);\n  const resetOrder = useCallback(() => {\n    dispatch({\n      type: types.RESET\n    }); // eslint-disable-next-line\n  }, []);\n  return { ...state,\n    addProduct,\n    removeProduct,\n    updateCount,\n    addCustomer,\n    addPayment,\n    updatePayment,\n    removePayment,\n    addShipment,\n    addCustomerNote,\n    resetOrder,\n    changeDelivered,\n    changeSale,\n    getPackages\n  };\n};\n\n_s2(useSalesCounter, \"tYPl7mgHKzQMna++l8NCj5WPwDY=\", false, function () {\n  return [useSelector];\n});\n\nexport default ProviderContext;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProviderContext\");","map":{"version":3,"sources":["/Users/mac3/Desktop/workspace/PosClient/src/features/dashboard/pages/sales-counters/state/context.tsx"],"names":["React","createContext","useCallback","useContext","useEffect","useMemo","useImmerReducer","useSelector","getPackagesActive","checkRestrictAction","useOrdersDraft","reducer","initialState","types","initialContext","state","dispatch","Context","ProviderContext","children","order","updateOrdersDraft","type","LOAD_NEW_ORDER_DRAFT","payload","id","products","payments","customer","shipment","customerNote","moneyCustomer","delivered","sale","isRestrictAction","createdBy","value","useSalesCounter","store","getPackages","packages","_id","pkgsActive","filter","item","active","CHANGE_IS_RESTRICT_ACTION","addProduct","product","ADD_PRODUCT","removeProduct","REMOVE_PRODUCT","updateCount","UPDATE_QUANTITY","addCustomer","ADD_CUSTOMER","addPayment","payment","ADD_PAYMENT","updatePayment","UPDATE_PAYMENT","removePayment","REMOVE_PAYMENT","addShipment","ADD_SHIPMENT","addCustomerNote","note","ADD_CUSTOMER_NOTE","changeDelivered","check","CHANGE_DELIVERED","changeSale","CHANGE_SALE","resetOrder","RESET"],"mappings":"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","sourcesContent":["import React, {\n    createContext,\n    FC,\n    ReactNode,\n    useCallback,\n    useContext,\n    useEffect,\n    useMemo,\n} from 'react';\nimport { useImmerReducer } from 'use-immer';\nimport { useSelector } from 'react-redux';\nimport { getPackagesActive } from '../../../../../api/billing-api';\nimport { IPackage } from '../../../../../collections/billing';\nimport { ICustomer } from '../../../../../collections/customer';\nimport { checkRestrictAction } from '../../../../../utils/get-time';\nimport { Payment, ProductState, IContext } from './interface';\nimport { useOrdersDraft } from './orders-draft-context';\nimport reducer, { initialState } from './reducer';\nimport { types } from './types';\n\nconst initialContext = {\n    state: initialState,\n    dispatch: () => {},\n};\n\nconst Context = createContext<IContext>(initialContext);\n\ninterface Props {\n    children: ReactNode;\n    order: any;\n}\n\nconst ProviderContext: FC<Props> = ({ children, order }) => {\n    const { updateOrdersDraft } = useOrdersDraft();\n    const [state, dispatch] = useImmerReducer(reducer, order || initialState);\n\n    useEffect(() => {\n        dispatch({\n            type: types.LOAD_NEW_ORDER_DRAFT,\n            payload: order,\n        });\n    }, [order.id]);\n\n    useEffect(() => {\n        if (state.id === order.id) {\n            updateOrdersDraft(state);\n        } else {\n            dispatch({\n                type: types.LOAD_NEW_ORDER_DRAFT,\n                payload: order,\n            });\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [\n        state.id,\n        state.products,\n        state.payments,\n        state.customer,\n        state.shipment,\n        state.customerNote,\n        state.moneyCustomer,\n        state.delivered,\n        state.sale,\n        state.isRestrictAction,\n        state.createdBy,\n    ]);\n\n    // eslint-disable-next-line\n    const value = useMemo(() => ({ state, dispatch }), [state]);\n\n    return <Context.Provider value={value}>{children}</Context.Provider>;\n};\n\nexport const useSalesCounter = () => {\n    const value = useContext(Context);\n    const { state, dispatch } = value;\n\n    const store = useSelector((state: any) => state.store.store);\n\n    const getPackages = async () => {\n        const packages: IPackage[] = await getPackagesActive(store._id);\n        const pkgsActive = packages.filter((item: IPackage) => item.active);\n\n        dispatch({\n            type: types.CHANGE_IS_RESTRICT_ACTION,\n            payload: checkRestrictAction(pkgsActive),\n        });\n    };\n\n    const addProduct = useCallback((product: ProductState) => {\n        dispatch({\n            type: types.ADD_PRODUCT,\n            payload: product,\n        });\n        // eslint-disable-next-line\n    }, []);\n\n    const removeProduct = (product: ProductState) => {\n        dispatch({\n            type: types.REMOVE_PRODUCT,\n            payload: product,\n        });\n    };\n\n    const updateCount = useCallback((product: ProductState) => {\n        dispatch({\n            type: types.UPDATE_QUANTITY,\n            payload: product,\n        });\n\n        // eslint-disable-next-line\n    }, []);\n\n    const addCustomer = useCallback((customer: ICustomer) => {\n        dispatch({\n            type: types.ADD_CUSTOMER,\n            payload: customer,\n        });\n\n        // eslint-disable-next-line\n    }, []);\n\n    const addPayment = useCallback((payment: Payment) => {\n        dispatch({\n            type: types.ADD_PAYMENT,\n            payload: payment,\n        });\n\n        // eslint-disable-next-line\n    }, []);\n\n    const updatePayment = useCallback((payment: Payment) => {\n        dispatch({\n            type: types.UPDATE_PAYMENT,\n            payload: payment,\n        });\n\n        // eslint-disable-next-line\n    }, []);\n\n    const removePayment = useCallback((payment: Payment) => {\n        dispatch({\n            type: types.REMOVE_PAYMENT,\n            payload: payment,\n        });\n\n        // eslint-disable-next-line\n    }, []);\n\n    const addShipment = useCallback((shipment: number) => {\n        dispatch({\n            type: types.ADD_SHIPMENT,\n            payload: shipment,\n        });\n\n        // eslint-disable-next-line\n    }, []);\n\n    const addCustomerNote = useCallback((note: string) => {\n        dispatch({\n            type: types.ADD_CUSTOMER_NOTE,\n            payload: note,\n        });\n\n        // eslint-disable-next-line\n    }, []);\n\n    const changeDelivered = useCallback((check: boolean) => {\n        dispatch({\n            type: types.CHANGE_DELIVERED,\n            payload: check,\n        });\n\n        // eslint-disable-next-line\n    }, []);\n\n    const changeSale = useCallback((check: boolean) => {\n        dispatch({\n            type: types.CHANGE_SALE,\n            payload: check,\n        });\n\n        // eslint-disable-next-line\n    }, []);\n\n    const resetOrder = useCallback(() => {\n        dispatch({\n            type: types.RESET,\n        });\n\n        // eslint-disable-next-line\n    }, []);\n\n    return {\n        ...state,\n        addProduct,\n        removeProduct,\n        updateCount,\n        addCustomer,\n        addPayment,\n        updatePayment,\n        removePayment,\n        addShipment,\n        addCustomerNote,\n        resetOrder,\n        changeDelivered,\n        changeSale,\n        getPackages,\n    };\n};\n\nexport default ProviderContext;\n"]},"metadata":{},"sourceType":"module"}