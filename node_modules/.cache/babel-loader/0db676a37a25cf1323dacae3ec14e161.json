{"ast":null,"code":"var _jsxFileName = \"/Users/mac3/Desktop/workspace/PosClient/src/features/settings/account/form.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport authApi from '../../../api/auth-api';\nimport { logout, updateUserSuccess } from '../../auth/state/auth-slide';\nimport { Form, Row, Col, Input, Divider, Space, Button, message } from 'antd';\nimport { Loading } from '../../../components';\nimport ChangePassword from './change-password';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst {\n  updateUserInfo,\n  changePassword\n} = authApi;\n\nconst FormSettingAccount = ({\n  toggleModal\n}) => {\n  _s();\n\n  const [form] = Form.useForm();\n  const [loading, setLoading] = useState(false);\n  const user = useSelector(state => state.auth.user);\n  const dispatch = useDispatch(); // const validatePhone = (\n  //     _: any,\n  //     value: string,\n  //     callback: (arg?: any) => void\n  // ) => {\n  //     const vnf_regex = /^(0|\\+84)(9|3|7|8|5){1}([0-9]{8})$/g;\n  //     if (value && vnf_regex.test(value) === false) {\n  //         return callback('Vui lòng nhập số điên thoại hợp lệ');\n  //     }\n  //     return callback();\n  // };\n\n  const onSubmit = async values => {\n    const {\n      name,\n      password,\n      newPassword\n    } = values;\n\n    try {\n      setLoading(true);\n\n      if (name !== user.name) {\n        await updateUserInfo({\n          name\n        }).then(() => {\n          dispatch(updateUserSuccess({ ...user,\n            name\n          }));\n          message.success('Cập nhật tài khoản thành công');\n          toggleModal();\n        }).catch(() => {\n          message.error('Cập nhật tài khoản thất bại');\n        });\n      }\n\n      if (password || newPassword) {\n        await changePassword({\n          currentPassword: password,\n          newPassword\n        }).then(() => {\n          dispatch(logout());\n          message.success('Cập nhật mật khẩu thành công. Vui lòng đăng nhập lại!');\n        }).catch(error => {\n          message.error('Cập nhật mật khẩu thất bại');\n          if (error.response.data.message === 'PASSWORD_INCORRECT') form.setFields([{\n            name: 'password',\n            errors: ['Mật khẩu không chính xác']\n          }]);\n        });\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [loading && /*#__PURE__*/_jsxDEV(Loading, {\n      full: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 25\n    }, this), /*#__PURE__*/_jsxDEV(Form, {\n      form: form,\n      layout: \"vertical\",\n      initialValues: user,\n      onFinish: onSubmit,\n      children: [/*#__PURE__*/_jsxDEV(Row, {\n        gutter: 20,\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          span: 12,\n          children: /*#__PURE__*/_jsxDEV(Form.Item, {\n            label: \"T\\xEAn \\u0111\\u1EA7y \\u0111\\u1EE7\",\n            name: \"name\",\n            rules: [{\n              required: true,\n              message: 'Trường này không được để trống'\n            }],\n            children: /*#__PURE__*/_jsxDEV(Input, {\n              placeholder: \"T\\xEAn \\u0111\\u1EA7y \\u0111\\u1EE7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 96,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          span: 12,\n          children: /*#__PURE__*/_jsxDEV(Form.Item, {\n            label: \"Email\",\n            name: \"email\",\n            children: /*#__PURE__*/_jsxDEV(Input, {\n              placeholder: \"my-email@example.com\",\n              disabled: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ChangePassword, {\n        form: form\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Space, {\n        size: 15,\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: toggleModal,\n          children: \"H\\u1EE7y\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          htmlType: \"submit\",\n          type: \"primary\",\n          children: \"C\\u1EADp nh\\u1EADt\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n\n_s(FormSettingAccount, \"ukste70cvVfm80/eSbhT0WsDI6M=\", false, function () {\n  return [Form.useForm, useSelector, useDispatch];\n});\n\n_c = FormSettingAccount;\nexport default FormSettingAccount;\n\nvar _c;\n\n$RefreshReg$(_c, \"FormSettingAccount\");","map":{"version":3,"sources":["/Users/mac3/Desktop/workspace/PosClient/src/features/settings/account/form.tsx"],"names":["React","useState","useSelector","useDispatch","authApi","logout","updateUserSuccess","Form","Row","Col","Input","Divider","Space","Button","message","Loading","ChangePassword","updateUserInfo","changePassword","FormSettingAccount","toggleModal","form","useForm","loading","setLoading","user","state","auth","dispatch","onSubmit","values","name","password","newPassword","then","success","catch","error","currentPassword","response","data","setFields","errors","required"],"mappings":"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","sourcesContent":["import React, { FC, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport authApi from '../../../api/auth-api';\nimport { logout, updateUserSuccess } from '../../auth/state/auth-slide';\n\nimport { Form, Row, Col, Input, Divider, Space, Button, message } from 'antd';\nimport { Loading } from '../../../components';\nimport ChangePassword from './change-password';\n\nconst { updateUserInfo, changePassword } = authApi;\n\ninterface Props {\n    toggleModal: () => void;\n}\n\nconst FormSettingAccount: FC<Props> = ({ toggleModal }) => {\n    const [form] = Form.useForm();\n    const [loading, setLoading] = useState<boolean>(false);\n\n    const user = useSelector((state: any) => state.auth.user);\n    const dispatch = useDispatch();\n\n    // const validatePhone = (\n    //     _: any,\n    //     value: string,\n    //     callback: (arg?: any) => void\n    // ) => {\n    //     const vnf_regex = /^(0|\\+84)(9|3|7|8|5){1}([0-9]{8})$/g;\n\n    //     if (value && vnf_regex.test(value) === false) {\n    //         return callback('Vui lòng nhập số điên thoại hợp lệ');\n    //     }\n\n    //     return callback();\n    // };\n\n    const onSubmit = async (values: any) => {\n        const { name, password, newPassword } = values;\n\n        try {\n            setLoading(true);\n\n            if (name !== user.name) {\n                await updateUserInfo({ name })\n                    .then(() => {\n                        dispatch(updateUserSuccess({ ...user, name }));\n                        message.success('Cập nhật tài khoản thành công');\n                        toggleModal();\n                    })\n                    .catch(() => {\n                        message.error('Cập nhật tài khoản thất bại');\n                    });\n            }\n\n            if (password || newPassword) {\n                await changePassword({ currentPassword: password, newPassword })\n                    .then(() => {\n                        dispatch(logout());\n                        message.success('Cập nhật mật khẩu thành công. Vui lòng đăng nhập lại!');\n                    })\n                    .catch((error: any) => {\n                        message.error('Cập nhật mật khẩu thất bại');\n\n                        if (error.response.data.message === 'PASSWORD_INCORRECT')\n                            form.setFields([\n                                {\n                                    name: 'password',\n                                    errors: ['Mật khẩu không chính xác'],\n                                },\n                            ]);\n                    });\n            }\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <>\n            {loading && <Loading full />}\n            <Form form={form} layout='vertical' initialValues={user} onFinish={onSubmit}>\n                <Row gutter={20}>\n                    {/* <Col span={12}>\n                    <Form.Item label='Tên đăng nhập' name=\"email\">\n                        <Input placeholder='Tên đăng nhập' />\n                    </Form.Item>\n                </Col> */}\n\n                    <Col span={12}>\n                        <Form.Item\n                            label='Tên đầy đủ'\n                            name='name'\n                            rules={[{ required: true, message: 'Trường này không được để trống' }]}\n                        >\n                            <Input placeholder='Tên đầy đủ' />\n                        </Form.Item>\n                    </Col>\n\n                    <Col span={12}>\n                        <Form.Item label='Email' name='email'>\n                            <Input placeholder='my-email@example.com' disabled />\n                        </Form.Item>\n                    </Col>\n\n                    {/* <Col span={12}>\n                    <Form.Item\n                        label='Số điện thoại'\n                        name='phone'\n                        rules={[{ validator: validatePhone }]}\n                    >\n                        <Input placeholder='0905645457' />\n                    </Form.Item>\n                </Col> */}\n                </Row>\n\n                <Divider />\n\n                <ChangePassword form={form} />\n\n                <Divider />\n\n                <Space size={15}>\n                    <Button onClick={toggleModal}>Hủy</Button>\n                    <Button htmlType='submit' type='primary'>\n                        Cập nhật\n                    </Button>\n                </Space>\n            </Form>\n        </>\n    );\n};\n\nexport default FormSettingAccount;\n"]},"metadata":{},"sourceType":"module"}