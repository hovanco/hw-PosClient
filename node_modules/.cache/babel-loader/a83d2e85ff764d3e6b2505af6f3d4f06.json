{"ast":null,"code":"var _jsxFileName = \"/Users/mac3/Desktop/workspace/PosClient/src/components/header/index.tsx\",\n    _s = $RefreshSig$();\n\nimport { Col, Row } from 'antd';\nimport { maxBy } from 'lodash';\nimport moment from 'moment';\nimport React, { useEffect, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { AliasPackage, EBillingPackageType, getPackagesActive } from '../../api/billing-api';\nimport { checkWarningExpiration } from '../../utils/get-time';\nimport BannerNotifyPackageTrial from '../banner-notify-package';\nimport BannerNotifyPackage from '../banner-notify-package/banner-package';\nimport HeaderLeft from './header-left';\nimport HeaderRight from './header-right';\nimport './header.less';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Header = () => {\n  _s();\n\n  const store = useSelector(state => state.store.store);\n  const [isExpired, setIsExpired] = useState(false);\n  const [expiredPackage, setExpiredPackage] = useState();\n  const [listNamePackage, setListNamePackage] = useState([]);\n  const [expiredTrial, setExpiredTrial] = useState();\n  const [isTrial, setIsTrial] = useState(false);\n\n  const handleCheckPackageType = packages => {\n    packages.forEach(item => {\n      if (item.packageType & EBillingPackageType.Trial) {\n        setIsTrial(checkWarningExpiration(item.expiredAt));\n        setExpiredTrial(item.expiredAt);\n        setIsExpired(false);\n      }\n    });\n  };\n\n  const handelGetMaxExpiredAt = packages => {\n    let selectedRows = [];\n    packages.filter(element => {\n      if (element.packageType & EBillingPackageType.Omni || element.packageType & EBillingPackageType.Trial || element.packageType & EBillingPackageType.Pos) selectedRows.push(element);\n    });\n    const packageMaxExpired = maxBy(selectedRows, function (o) {\n      return Math.round(moment(o.expiredAt).diff(moment(), 'days', true));\n    });\n    setIsExpired(checkWarningExpiration(packageMaxExpired === null || packageMaxExpired === void 0 ? void 0 : packageMaxExpired.expiredAt));\n    setExpiredPackage(Math.round(moment(packageMaxExpired === null || packageMaxExpired === void 0 ? void 0 : packageMaxExpired.expiredAt).diff(moment(), 'days', true)));\n\n    if (!checkWarningExpiration(packageMaxExpired === null || packageMaxExpired === void 0 ? void 0 : packageMaxExpired.expiredAt)) {\n      return;\n    }\n\n    let listName = [];\n    selectedRows.forEach(item => {\n      if (item.packageType & EBillingPackageType.Omni) {\n        listName.push(AliasPackage[EBillingPackageType.Omni]);\n      }\n\n      if (item.packageType & EBillingPackageType.Pos) {\n        listName.push(AliasPackage[EBillingPackageType.Pos]);\n      }\n    });\n    setListNamePackage(listName);\n  };\n\n  const getPackages = async () => {\n    const packages = await getPackagesActive(store._id);\n    handelGetMaxExpiredAt(packages);\n    handleCheckPackageType(packages);\n  };\n\n  useEffect(() => {\n    getPackages();\n  }, []);\n\n  const handleCloseBannerTrial = () => {\n    setIsTrial(false);\n  };\n\n  const handleCloseBannerFacebook = () => {\n    setIsExpired(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Col, {\n      span: 24,\n      style: {\n        padding: 'unset'\n      },\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        children: [isTrial && /*#__PURE__*/_jsxDEV(BannerNotifyPackageTrial, {\n          expiredAtPackage: expiredTrial,\n          isExpired: isTrial,\n          handleCloseBanner: handleCloseBannerTrial\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 25\n        }, this), isExpired && /*#__PURE__*/_jsxDEV(BannerNotifyPackage, {\n          expired: expiredPackage,\n          isExpired: isExpired,\n          handleCloseBanner: handleCloseBannerFacebook,\n          namePackage: (listNamePackage === null || listNamePackage === void 0 ? void 0 : listNamePackage.length) > 0 ? listNamePackage === null || listNamePackage === void 0 ? void 0 : listNamePackage.join(' ,') : ''\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"header\",\n      children: /*#__PURE__*/_jsxDEV(Row, {\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          span: 24,\n          children: /*#__PURE__*/_jsxDEV(Row, {\n            className: \"header-container\",\n            justify: \"space-between\",\n            align: \"middle\",\n            children: [/*#__PURE__*/_jsxDEV(Col, {\n              children: /*#__PURE__*/_jsxDEV(HeaderLeft, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 124,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              children: /*#__PURE__*/_jsxDEV(HeaderRight, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Header, \"agfXr6v+dI9SH9XO/VQ9gmbSdpM=\", false, function () {\n  return [useSelector];\n});\n\n_c = Header;\nexport default Header;\n\nvar _c;\n\n$RefreshReg$(_c, \"Header\");","map":{"version":3,"sources":["/Users/mac3/Desktop/workspace/PosClient/src/components/header/index.tsx"],"names":["Col","Row","maxBy","moment","React","useEffect","useState","useSelector","AliasPackage","EBillingPackageType","getPackagesActive","checkWarningExpiration","BannerNotifyPackageTrial","BannerNotifyPackage","HeaderLeft","HeaderRight","Header","store","state","isExpired","setIsExpired","expiredPackage","setExpiredPackage","listNamePackage","setListNamePackage","expiredTrial","setExpiredTrial","isTrial","setIsTrial","handleCheckPackageType","packages","forEach","item","packageType","Trial","expiredAt","handelGetMaxExpiredAt","selectedRows","filter","element","Omni","Pos","push","packageMaxExpired","o","Math","round","diff","listName","getPackages","_id","handleCloseBannerTrial","handleCloseBannerFacebook","padding","length","join"],"mappings":"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","sourcesContent":["import { Col, Row } from 'antd';\nimport { maxBy } from 'lodash';\nimport moment from 'moment';\nimport React, { FC, useEffect, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { AliasPackage, EBillingPackageType, getPackagesActive } from '../../api/billing-api';\nimport { IPackage } from '../../collections/billing';\nimport { checkWarningExpiration } from '../../utils/get-time';\nimport BannerNotifyPackageTrial from '../banner-notify-package';\nimport BannerNotifyPackage from '../banner-notify-package/banner-package';\nimport HeaderLeft from './header-left';\nimport HeaderRight from './header-right';\nimport './header.less';\n\ninterface IPackageDetail {\n    active: boolean;\n    bonusPeriod: number;\n    createdAt: string;\n    expiredAt: string;\n    packageType: number;\n    paymentType: number;\n    period: number;\n    storeId: string;\n    total: number;\n    transactionCode: string;\n    updatedAt: string;\n    id: string;\n}\n\nconst Header: FC = () => {\n    const store = useSelector((state: any) => state.store.store);\n    const [isExpired, setIsExpired] = useState<boolean>(false);\n    const [expiredPackage, setExpiredPackage] = useState<number>();\n    const [listNamePackage, setListNamePackage] = useState<Array<string>>([]);\n    const [expiredTrial, setExpiredTrial] = useState<string>();\n    const [isTrial, setIsTrial] = useState<boolean>(false);\n\n    const handleCheckPackageType = (packages: IPackage[]) => {\n        packages.forEach((item: IPackageDetail) => {\n            if (item.packageType & EBillingPackageType.Trial) {\n                setIsTrial(checkWarningExpiration(item.expiredAt));\n                setExpiredTrial(item.expiredAt);\n                setIsExpired(false);\n            }\n        });\n    };\n\n    const handelGetMaxExpiredAt = (packages: IPackage[]) => {\n        let selectedRows: IPackage[] = [];\n        packages.filter((element: IPackageDetail) => {\n            if (\n                element.packageType & EBillingPackageType.Omni ||\n                element.packageType & EBillingPackageType.Trial ||\n                element.packageType & EBillingPackageType.Pos\n            )\n                selectedRows.push(element);\n        });\n        const packageMaxExpired: IPackageDetail = maxBy(selectedRows, function (o) {\n            return Math.round(moment(o.expiredAt).diff(moment(), 'days', true));\n        });\n        setIsExpired(checkWarningExpiration(packageMaxExpired?.expiredAt));\n        setExpiredPackage(\n            Math.round(moment(packageMaxExpired?.expiredAt).diff(moment(), 'days', true)),\n        );\n        if (!checkWarningExpiration(packageMaxExpired?.expiredAt)) {\n            return;\n        }\n        let listName: Array<string> = [];\n        selectedRows.forEach((item: IPackageDetail) => {\n            if (item.packageType & EBillingPackageType.Omni) {\n                listName.push(AliasPackage[EBillingPackageType.Omni]);\n            }\n            if (item.packageType & EBillingPackageType.Pos) {\n                listName.push(AliasPackage[EBillingPackageType.Pos]);\n            }\n        });\n        setListNamePackage(listName);\n    };\n\n    const getPackages = async () => {\n        const packages: IPackage[] = await getPackagesActive(store._id);\n        handelGetMaxExpiredAt(packages);\n        handleCheckPackageType(packages);\n    };\n    useEffect(() => {\n        getPackages();\n    }, []);\n\n    const handleCloseBannerTrial = () => {\n        setIsTrial(false);\n    };\n    const handleCloseBannerFacebook = () => {\n        setIsExpired(false);\n    };\n\n    return (\n        <>\n            <Col span={24} style={{ padding: 'unset' }}>\n                <Col>\n                    {isTrial && (\n                        <BannerNotifyPackageTrial\n                            expiredAtPackage={expiredTrial}\n                            isExpired={isTrial}\n                            handleCloseBanner={handleCloseBannerTrial}\n                        />\n                    )}\n                    {isExpired && (\n                        <BannerNotifyPackage\n                            expired={expiredPackage}\n                            isExpired={isExpired}\n                            handleCloseBanner={handleCloseBannerFacebook}\n                            namePackage={\n                                listNamePackage?.length > 0 ? listNamePackage?.join(' ,') : ''\n                            }\n                        />\n                    )}\n                </Col>\n            </Col>\n            <div className='header'>\n                <Row>\n                    <Col span={24}>\n                        <Row className='header-container' justify='space-between' align='middle'>\n                            <Col>\n                                <HeaderLeft />\n                            </Col>\n                            <Col>\n                                <HeaderRight />\n                            </Col>\n                        </Row>\n                    </Col>\n                </Row>\n            </div>\n        </>\n    );\n};\n\nexport default Header;\n"]},"metadata":{},"sourceType":"module"}