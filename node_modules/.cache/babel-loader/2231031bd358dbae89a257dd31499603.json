{"ast":null,"code":"var _jsxFileName = \"/Users/mac3/Desktop/workspace/PosClient/src/features/auth/pages/save-token.tsx\",\n    _s = $RefreshSig$();\n\nimport { message } from 'antd';\nimport * as queryString from 'query-string';\nimport React, { useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport { setToken } from '../../../api/token';\nimport { Loading } from '../../../components';\nimport { BaseLayout } from '../../../layout';\nimport { loadUser } from '../state/auth-slide';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst SaveToken = props => {\n  _s();\n\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const searchState = queryString.parse(history.location.search);\n\n  const saveAndLoadUser = async () => {\n    const {\n      token,\n      remember,\n      location\n    } = searchState;\n\n    if (!token || !location) {\n      return;\n    }\n\n    const rememberValue = remember === 'true';\n    const tokenValue = JSON.parse(token);\n    const locationValue = JSON.parse(location);\n    await setToken({\n      token: tokenValue,\n      remember: rememberValue\n    });\n    await dispatch(loadUser());\n    message.success('Đăng nhập thành công');\n\n    if (locationValue.pathname.includes('/auth')) {\n      history.replace('/dashboard/sales-counters');\n      return;\n    }\n\n    history.replace(locationValue);\n  };\n\n  useEffect(() => {\n    saveAndLoadUser();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(BaseLayout, {\n    title: \"Login\",\n    children: /*#__PURE__*/_jsxDEV(Loading, {\n      full: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 9\n  }, this);\n};\n\n_s(SaveToken, \"7u3xwS4PqIKuFyHlFGn/5M55K3I=\", false, function () {\n  return [useHistory, useDispatch];\n});\n\n_c = SaveToken;\nexport default SaveToken;\n\nvar _c;\n\n$RefreshReg$(_c, \"SaveToken\");","map":{"version":3,"sources":["/Users/mac3/Desktop/workspace/PosClient/src/features/auth/pages/save-token.tsx"],"names":["message","queryString","React","useEffect","useDispatch","useHistory","setToken","Loading","BaseLayout","loadUser","SaveToken","props","history","dispatch","searchState","parse","location","search","saveAndLoadUser","token","remember","rememberValue","tokenValue","JSON","locationValue","success","pathname","includes","replace"],"mappings":";;;AAAA,SAASA,OAAT,QAAwB,MAAxB;AACA,OAAO,KAAKC,WAAZ,MAA6B,cAA7B;AACA,OAAOC,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAAiBC,QAAjB,QAAiC,oBAAjC;AACA,SAASC,OAAT,QAAwB,qBAAxB;AACA,SAASC,UAAT,QAA2B,iBAA3B;AACA,SAASC,QAAT,QAAyB,qBAAzB;;;AAIA,MAAMC,SAAS,GAAIC,KAAD,IAAkB;AAAA;;AAChC,QAAMC,OAAO,GAAGP,UAAU,EAA1B;AACA,QAAMQ,QAAQ,GAAGT,WAAW,EAA5B;AAEA,QAAMU,WAIL,GAAGb,WAAW,CAACc,KAAZ,CAAkBH,OAAO,CAACI,QAAR,CAAiBC,MAAnC,CAJJ;;AAMA,QAAMC,eAAe,GAAG,YAA2B;AAC/C,UAAM;AAAEC,MAAAA,KAAF;AAASC,MAAAA,QAAT;AAAmBJ,MAAAA;AAAnB,QAAgCF,WAAtC;;AAEA,QAAI,CAACK,KAAD,IAAU,CAACH,QAAf,EAAyB;AACrB;AACH;;AACD,UAAMK,aAAa,GAAGD,QAAQ,KAAK,MAAnC;AACA,UAAME,UAAkB,GAAGC,IAAI,CAACR,KAAL,CAAWI,KAAX,CAA3B;AACA,UAAMK,aAAuB,GAAGD,IAAI,CAACR,KAAL,CAAWC,QAAX,CAAhC;AAEA,UAAMV,QAAQ,CAAC;AAAEa,MAAAA,KAAK,EAAEG,UAAT;AAAqBF,MAAAA,QAAQ,EAAEC;AAA/B,KAAD,CAAd;AACA,UAAMR,QAAQ,CAACJ,QAAQ,EAAT,CAAd;AACAT,IAAAA,OAAO,CAACyB,OAAR,CAAgB,sBAAhB;;AAEA,QAAID,aAAa,CAACE,QAAd,CAAuBC,QAAvB,CAAgC,OAAhC,CAAJ,EAA8C;AAC1Cf,MAAAA,OAAO,CAACgB,OAAR,CAAgB,2BAAhB;AACA;AACH;;AAEDhB,IAAAA,OAAO,CAACgB,OAAR,CAAgBJ,aAAhB;AACH,GApBD;;AAsBArB,EAAAA,SAAS,CAAC,MAAM;AACZe,IAAAA,eAAe;AAClB,GAFQ,EAEN,EAFM,CAAT;AAIA,sBACI,QAAC,UAAD;AAAY,IAAA,KAAK,EAAC,OAAlB;AAAA,2BACI,QAAC,OAAD;AAAS,MAAA,IAAI;AAAb;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,UADJ;AAKH,CAzCD;;GAAMR,S;UACcL,U,EACCD,W;;;KAFfM,S;AA2CN,eAAeA,SAAf","sourcesContent":["import { message } from 'antd';\nimport * as queryString from 'query-string';\nimport React, { useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport { IToken, setToken } from '../../../api/token';\nimport { Loading } from '../../../components';\nimport { BaseLayout } from '../../../layout';\nimport { loadUser } from '../state/auth-slide';\n\ninterface Props {}\n\nconst SaveToken = (props: Props) => {\n    const history = useHistory();\n    const dispatch = useDispatch();\n\n    const searchState: {\n        token?: string;\n        remember?: string;\n        location?: string;\n    } = queryString.parse(history.location.search);\n\n    const saveAndLoadUser = async (): Promise<void> => {\n        const { token, remember, location } = searchState;\n\n        if (!token || !location) {\n            return;\n        }\n        const rememberValue = remember === 'true';\n        const tokenValue: IToken = JSON.parse(token);\n        const locationValue: Location = JSON.parse(location);\n\n        await setToken({ token: tokenValue, remember: rememberValue });\n        await dispatch(loadUser());\n        message.success('Đăng nhập thành công');\n\n        if (locationValue.pathname.includes('/auth')) {\n            history.replace('/dashboard/sales-counters');\n            return;\n        }\n\n        history.replace(locationValue);\n    };\n\n    useEffect(() => {\n        saveAndLoadUser();\n    }, []);\n\n    return (\n        <BaseLayout title='Login'>\n            <Loading full />\n        </BaseLayout>\n    );\n};\n\nexport default SaveToken;\n"]},"metadata":{},"sourceType":"module"}